<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="initial-scale=1,width=device-width"
    />
    <title> ARC Demo</title>

    <style>
      html,
      body,
      #viewDiv {
	    position: absolute;
		top: 21px;
	   	padding: 0;
        margin: 0;
        height: 97%;
        width: 100%;
      }
	  #optionsDiv {
      position: absolute;
      bottom: 10px;
      width: 100%;
      padding: 20px ;
      z-index: 1;
      text-align: center;
    }

    .button {
      background: white;
      padding: 7px;
      border: 1px solid #005e95;
      font-size: 0.9em;
      margin: 5px;
      color: #005e95;
      font-family: "Avenir Next W01", "Arial", sans-serif;
    }
	
	.button1
	{
	background-image: url("ARClogo.jpg");
	}
	
	.button2
	{
	background: red;
	border-radius: 50%;
	}
	
	.button3
	{
	background: orange;
    border-radius: 30%;
	}
	
	.button4
	{
	background: green;
	}
	
	
	.button1:hover {
      background: #005e95;
      color: white;
      cursor: pointer;
    }
	
	.button2:hover {
      background: #005e95;
      color: white;
      cursor: pointer;
    }
	
	.button3:hover {
      background: #005e95;
      color: white;
      cursor: pointer;
    }
	
	.button4:hover {
      background: #005e95;
      color: white;
      cursor: pointer;
    }
	
    </style>
    <link
      rel="stylesheet"
      href="https://js.arcgis.com/4.11/esri/themes/light/main.css"
    />
    <script src="https://js.arcgis.com/4.11/"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.js"></script>
	
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	
    <script>
      require([
        "esri/widgets/Track",
        "esri/views/MapView",
        "esri/Map",
		"esri/layers/CSVLayer",
        "esri/views/SceneView"
      ], function(Track, MapView, Map, CSVLayer,SceneView) {
        var map = new Map({
          basemap: "streets-navigation-vector",
		  ground: "world-elevation"
        });

        var view = new MapView({
          map: map,
          container: "viewDiv",
		  scale: 50000000,          // Sets the initial scale to 1:50,000,000
    center: [2, 49] 
        });

        // Create an instance of the Track widget
        // and add it to the view's UI
        var track = new Track({
         
    view: view
        });
        view.ui.add(track, "top-left");
		
    
        
  document.getElementById("Position").addEventListener("click",
          function() {
	//  track.start();
	     getLocation();
          });
		  
		 document.getElementById("Emergency").addEventListener("click",
          function() {
		  launchFullscreen(document.documentElement);
	  // document.getElementById("viewDiv").style.opacity = "0.6";
	  
          });

		  var coordsWidget = document.createElement("div");
      coordsWidget.id = "coordsWidget";
      coordsWidget.className = "esri-widget esri-component";
      coordsWidget.style.padding = "7px 15px 5px";

      view.ui.add(coordsWidget, "bottom-right");
		  
		  function showCoordinates(pt) {
        var coords = "Lat/Lon " + pt.latitude.toFixed(3) + " " + pt.longitude.toFixed(3);
        coordsWidget.innerHTML = coords;
      }
		
      view.watch("stationary", function(isStationary) {
        showCoordinates(view.center);
      });

      view.on("pointer-move", function(evt) {
        showCoordinates(view.toMap({ x: evt.x, y: evt.y }));
      });	
	  
 function launchFullscreen(element) {
   
  if (!document.fullscreenElement) {
      document.documentElement.requestFullscreen();
	  }
}





    /*  view.on("click", function(evt) {
        alert("click!");
      });	*/	  
	  
/////////////////////////////////////////////////////////////

var ipx
var latitude
var longitude 

function getLocation() {
    //Check if Geolocation is supported 
	//getIPAddress();
	 //useIPposition();
   if (navigator.geolocation) {
      //the watchposition() method show the position of the user and update it while is moving
        navigator.geolocation.getCurrentPosition(useposition, showError);
    } else { 
      //If not, display a message to the user
      //useIPposition();
	  alert("Error");
    }*/
	
	
}
//The showPosition() function outputs the Latitude and Longitude
function useposition(position) {
    latitude= position.coords.latitude; 
    longitude=position.coords.longitude;
	Drawippoint();
}

function showError(error) {
  switch(error.code) {
    case error.PERMISSION_DENIED:
      alert( "User denied the request for Geolocation.")
      break;
    case error.POSITION_UNAVAILABLE:
      alert("Location information is unavailable.")
      break;
    case error.TIMEOUT:
      alert("The request to get user location timed out.")
      break;
    case error.UNKNOWN_ERROR:
      alert("An unknown error occurred.")
      break;
  }
}

function useIPposition(){

$.getJSON("http://ip-api.com/json/", function (dete) {
latitude=dete.lat;
longitude=dete.lon;
alert("Your location is " + dete.lat + ";" + dete.lon);
		 
Drawippoint();});
};
    

function Drawippoint(){




      // Create a symbol for drawing the point
   /*   var markerSymbol = new SimpleMarkerSymbol({
        color: [226, 119, 40],
        outline: {
          color: [255, 255, 255],
          width: 1
        }
      });

      // Create a graphic and add the geometry and symbol to it
      var pointGraphic = new Graphic({
        geometry: point,
        symbol: markerSymbol
      });

      // Add the graphic to the view
/*view.graphics.add(pointGraphic);*/
  alert(latitude+";"+longitude);  
view.center = [longitude,latitude];
view.zoom = 40;
	  
	  }
	  
	

	
	  });
    </script>
  </head>

  <body>
  
    <div id="viewDiv"></div>
	<div id="optionsDiv">
	  <button id="Position" class="button button1">Position</button>
 	  <button id="Emergency" class="button button2">+E</button>
	  <button id="Maintenance" class="button button3">+M</button>
	  <button id="Services" class="button button4">+S</button>
</div>
 <nav class="navbar navbar-expand-lg fixed-top ">
	  <a class="navbar-brand" href="#">ARC</a>
	 

	  <div class="navbar-brand " id="navbarSupportedContent">
	    <ul class="navbar-nav mr-4">
	    
	      <li class="nav-item">
	        <a class="nav-link " data-value="contact" href="#">Contact</a>
	      </li>
	    </ul>
	    
	  </div>
</nav>


  </body>
</html>
